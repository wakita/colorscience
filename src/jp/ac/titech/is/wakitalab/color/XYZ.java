package jp.ac.titech.is.wakitalab.color;

/**
 * $Id: XYZ.java,v 1.4 2004/05/17 00:00:31 wakita Exp $
 * @author Ken Wakita
 * @version Experimental, Jan 19, 2003
 */

public class XYZ extends _XYZ {

    public XYZ(double X, double Y, double Z) {
        _initialize(X, Y, Z);
    }

    public XYZ() {
    }

    public XYZ(double xyz[]) {
        this(xyz[0], xyz[1], xyz[2]);
        assert xyz.length == 3;
    }

    public XYZ(XYZ c) { this(c.X, c.Y, c.Z); }

    /** <p>The standard nominal white color used as by default.</p>
     */

    public static XYZ standardWhite;

    // Initialization of XYZ::initialize depends on Illuminant::initialize
    static void initialize() {
        standardWhite = Illuminant.WhiteD65.XYZ();
    }

    /**
     * Chromaticity coordinates x(l), y(l), and z(l) for spectrally pure
     * monochromatic colors and a field of 2-deg (CIE, 1932). It was taken from
     * Malacara's book, p. 59, Table 4.4.
     */
    public static final CMF chromaticityCoordinate2deg =
        new CMF(380, 780, 5, new double[][] {
                {
                    0.1741, 0.1740, 0.1738, 0.1736, // 380
                    0.1733, 0.1730, 0.1726, 0.1721, // 400
                    0.1714, 0.1703, 0.1689, 0.1669, // 420
                    0.1644, 0.1411, 0.1566, 0.1510, // 440
                    0.1440, 0.1355, 0.1241, 0.1096, // 460
                    0.0913, 0.0687, 0.0454, 0.0235, // 480
                    0.0082, 0.0039, 0.0139, 0.0389, // 500
                    0.0743, 0.1142, 0.1547, 0.1929, // 520
                    0.2296, 0.2658, 0.3016, 0.3373, // 540
                    0.3731, 0.4087, 0.4441, 0.4788, // 560
                    0.5125, 0.5448, 0.5752, 0.6029, // 580
                    0.6270, 0.6482, 0.6658, 0.6801, // 600
                    0.6915, 0.7006, 0.7079, 0.7140, // 620
                    0.7190, 0.7230, 0.7260, 0.7283, // 640
                    0.7300, 0.7311, 0.7320, 0.7327, // 660
                    0.7334, 0.7340, 0.7344, 0.7346, // 680
                    0.7347, 0.7347, 0.7347, 0.7347, // 700
                    0.7347, 0.7347, 0.7347, 0.7347, // 720
                    0.7334, 0.7340, 0.7344, 0.7346, // 740
                    0.7334, 0.7340, 0.7344, 0.7346, // 760
                    0.7334 // 780
                }, {
                    0.0050, 0.0050, 0.0049, 0.0049, // 380
                    0.0048, 0.0048, 0.0048, 0.0048, // 400
                    0.0051, 0.0058, 0.0069, 0.0086, // 420
                    0.0109, 0.0138, 0.0177, 0.0227, // 440
                    0.0297, 0.0399, 0.0578, 0.0868, // 460
                    0.1327, 0.2007, 0.2950, 0.4127, // 480
                    0.5384, 0.6548, 0.7502, 0.8120, // 500
                    0.8338, 0.8262, 0.8059, 0.7816, // 520
                    0.7543, 0.7243, 0.6923, 0.6589, // 540
                    0.6245, 0.5796, 0.5547, 0.5202, // 560
                    0.4866, 0.4544, 0.4242, 0.3965, // 580
                    0.3725, 0.3514, 0.3340, 0.3197, // 600
                    0.3083, 0.2993, 0.2920, 0.2859, // 620
                    0.2809, 0.2770, 0.2740, 0.2717, // 640
                    0.2700, 0.2689, 0.2680, 0.2673, // 660
                    0.2666, 0.2660, 0.2656, 0.2654, // 680
                    0.2653, 0.2653, 0.2653, 0.2653, // 700
                    0.2653, 0.2653, 0.2653, 0.2653, // 720
                    0.2653, 0.2653, 0.2653, 0.2653, // 740
                    0.2653, 0.2653, 0.2653, 0.2653, // 760
                    0.2653 // 780
                }, {
                    0.8209, 0.8210, 0.8213, 0.8215, // 380
                    0.8219, 0.8222, 0.8226, 0.8231, // 400
                    0.8235, 0.8239, 0.8242, 0.8245, // 420
                    0.8247, 0.8251, 0.8257, 0.8263, // 440
                    0.8263, 0.8246, 0.8181, 0.8036, // 460
                    0.7760, 0.7306, 0.6596, 0.5638, // 480
                    0.4534, 0.3413, 0.2359, 0.1491, // 500
                    0.0919, 0.0596, 0.0394, 0.0255, // 520
                    0.0161, 0.0099, 0.0061, 0.0038, // 540
                    0.0024, 0.0017, 0.0012, 0.0010, // 560
                    0.0009, 0.0008, 0.0006, 0.0006, // 580
                    0.0005, 0.0004, 0.0002, 0.0002, // 600
                    0.0002, 0.0001, 0.0001, 0.0001, // 620
                    0.0001, 0.0000, 0.0000, 0.0000, // 640
                    0.0000, 0.0000, 0.0000, 0.0000, // 660
                    0.0000, 0.0000, 0.0000, 0.0000, // 680
                    0.0000, 0.0000, 0.0000, 0.0000, // 700
                    0.0000, 0.0000, 0.0000, 0.0000, // 720
                    0.0000, 0.0000, 0.0000, 0.0000, // 740
                    0.0000, 0.0000, 0.0000, 0.0000, // 760
                    0.0000 // 780
                } });

    /**
     * Chromaticity coordinates x(l), y(l), and z(l) for spectrally pure
     * monochromatic colors and a field of 10-deg (CIE, 1964). It was taken from
     * Malacara's book, p. 62, Table 4.6.
     */
    public static final CMF chromaticityCoordinate10deg =
        new CMF(380, 780, 5, new double[][] {
                {
                    0.1813, 0.1809, 0.1803, 0.1795, // 380
                    0.1784, 0.1771, 0.1755, 0.1732, // 400
                    0.1706, 0.1679, 0.1650, 0.1622, // 420
                    0.1590, 0.1554, 0.1510, 0.1459, // 440
                    0.1389, 0.1295, 0.1152, 0.0957, // 460
                    0.0728, 0.0452, 0.0210, 0.0073, // 480
                    0.0056, 0.0219, 0.0495, 0.0850, // 500
                    0.1252, 0.1664, 0.2070, 0.2436, // 520
                    0.2786, 0.3132, 0.3473, 0.3812, // 540
                    0.4142, 0.4469, 0.4790, 0.5096, // 560
                    0.5386, 0.5654, 0.5900, 0.6116, // 580
                    0.6306, 0.6471, 0.6612, 0.6730, // 600
                    0.6827, 0.6897, 0.6955, 0.7010, // 620
                    0.7059, 0.7102, 0.7137, 0.7156, // 640
                    0.7158, 0.7179, 0.7187, 0.7193, // 660
                    0.7198, 0.7200, 0.7202, 0.7203, // 680
                    0.7203, 0.7203, 0.7202, 0.7201, // 700
                    0.7199, 0.7197, 0.7194, 0.7192, // 720
                    0.7189, 0.7186, 0.7183, 0.7179, // 740
                    0.7176, 0.7172, 0.7168, 0.7165, // 760
                    0.7160 // 780
                }, {
                    0.0197, 0.0195, 0.0193, 0.0190, // 380
                    0.0187, 0.0184, 0.0181, 0.0178, // 400
                    0.0178, 0.0187, 0.0203, 0.0249, // 420
                    0.0252, 0.0300, 0.0364, 0.0452, // 440
                    0.0589, 0.0779, 0.1090, 0.1591, // 460
                    0.2292, 0.3273, 0.4401, 0.5625, // 480
                    0.6745, 0.7526, 0.8023, 0.8169, // 500
                    0.8102, 0.7922, 0.7963, 0.7399, // 520
                    0.7113, 0.6813, 0.6501, 0.6182, // 540
                    0.5859, 0.5531, 0.5210, 0.4903, // 560
                    0.4614, 0.4345, 0.4100, 0.3884, // 580
                    0.3694, 0.3529, 0.3388, 0.3269, // 600
                    0.3173, 0.3102, 0.3045, 0.2990, // 620
                    0.2941, 0.2897, 0.2863, 0.2844, // 640
                    0.2832, 0.2821, 0.2813, 0.2806, // 660
                    0.2802, 0.2800, 0.2798, 0.2797, // 680
                    0.2796, 0.2797, 0.2798, 0.2799, // 700
                    0.2801, 0.2803, 0.2805, 0.2808, // 720
                    0.2811, 0.2814, 0.2817, 0.2820, // 740
                    0.2824, 0.2828, 0.2831, 0.2835, // 760
                    0.2839 // 780
                }, {
                    0.7990, 0.7995, 0.8003, 0.8015, // 380
                    0.8029, 0.8045, 0.8064, 0.8090, // 400
                    0.8115, 0.8134, 0.8147, 0.8153, // 420
                    0.8152, 0.8146, 0.8126, 0.8088, // 440
                    0.8021, 0.7926, 0.7758, 0.7452, // 460
                    0.6980, 0.6275, 0.5389, 0.4302, // 480
                    0.3199, 0.2255, 0.1481, 0.0980, // 500
                    0.0646, 0.0414, 0.0267, 0.0165, // 520
                    0.0101, 0.0055, 0.0026, 0.0007, // 540
                    0.0000, 0.0000, 0.0000, 0.0000, // 560
                    0.0000, 0.0000, 0.0000, 0.0000, // 580
                    0.0000, 0.0000, 0.0000, 0.0000, // 600
                    0.0000, 0.0000, 0.0000, 0.0000, // 620
                    0.0000, 0.0000, 0.0000, 0.0000, // 640
                    0.0000, 0.0000, 0.0000, 0.0000, // 660
                    0.0000, 0.0000, 0.0000, 0.0000, // 680
                    0.0000, 0.0000, 0.0000, 0.0000, // 700
                    0.0000, 0.0000, 0.0000, 0.0000, // 720
                    0.0000, 0.0000, 0.0000, 0.0000, // 740
                    0.0000, 0.0000, 0.0000, 0.0000, // 760
                    0.0000 // 780
                } });

    // Color Vision and Colorimetry: Theory and Applications, p.69
    // A_2 : (Xn = 109.850, Yn = 100.00, Zn = 35.585)
    // A_10 : (Xn = 111.144, Yn = 100.00, Zn = 35.201)
    // D65_2 : (Xn = 95.053, Yn = 100.00, Zn = 108.900)
    // D65_10 : (Xn = 94.812, Yn = 100.00, Zn = 107.327)

    /* _定義するのはここでいいのかよく分からない。_ */
    public XYZ getDichromatColor(VisionType t){
        return LMS().getDichromatColor(t).XYZ();
    }

}
